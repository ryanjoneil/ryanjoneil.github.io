<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>obfuscation on adventures in optimization</title>
    <link>https://ryanjoneil.github.io/tags/obfuscation/</link>
    <description>Recent content in obfuscation on adventures in optimization</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <lastBuildDate>Mon, 18 Apr 2011 00:00:00 +0000</lastBuildDate><atom:link href="https://ryanjoneil.github.io/tags/obfuscation/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>üê™ Reformed JAPHs: Turing Machine</title>
      <link>https://ryanjoneil.github.io/posts/2011-04-18-reformed-japhs-turing-machine/</link>
      <pubDate>Mon, 18 Apr 2011 00:00:00 +0000</pubDate>
      
      <guid>https://ryanjoneil.github.io/posts/2011-04-18-reformed-japhs-turing-machine/</guid>
      <description>Python obfuscation with a Turing machine</description>
      <content:encoded><![CDATA[<p><em>Note: This post was edited for clarity.</em></p>
<p>This JAPH uses a <a href="https://en.wikipedia.org/wiki/Turing_machine">Turing machine</a>. The machine accepts any string that ends in <code>'\n'</code> and allows side effects. This lets us print the value of the tape as it encounters each character. While the idea of using lambda functions as side effects in a Turing machine is a little bizarre on many levels, we work with what we have. And Python is multi-paradigmatic, so what the heck.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">turing</span>(tape, transitions):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># The tape input comes in as a string.  We approximate an infinite</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># length tape via a hash, so we need to convert this to {index: value}</span>
</span></span><span style="display:flex;"><span>    tape_hash <span style="color:#f92672">=</span> {i: x <span style="color:#66d9ef">for</span> i, x <span style="color:#f92672">in</span> enumerate(tape)}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Start at 0 using our transition matrix</span>
</span></span><span style="display:flex;"><span>    index <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    state <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>        value <span style="color:#f92672">=</span> tape_hash<span style="color:#f92672">.</span>get(index, <span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># This is a modified Turing machine: it uses regexen</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># and has side effects.  Oh well, I needed IO.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> rule <span style="color:#f92672">in</span> transitions[state]:
</span></span><span style="display:flex;"><span>            regex, next, direction, new_value, side_effect <span style="color:#f92672">=</span> rule
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> re<span style="color:#f92672">.</span><span style="color:#66d9ef">match</span>(regex, value):
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># Terminal states</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> new_value <span style="color:#f92672">in</span> (<span style="color:#e6db74">&#39;YES&#39;</span>, <span style="color:#e6db74">&#39;NO&#39;</span>):
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> new_value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                tape_hash[index] <span style="color:#f92672">=</span> new_value
</span></span><span style="display:flex;"><span>                side_effect(value)
</span></span><span style="display:flex;"><span>                index <span style="color:#f92672">+=</span> direction
</span></span><span style="display:flex;"><span>                state <span style="color:#f92672">=</span> next
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">assert</span> <span style="color:#e6db74">&#39;YES&#39;</span> <span style="color:#f92672">==</span> turing(<span style="color:#e6db74">&#39;just another python hacker</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, [
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># This Turing machine recognizes the language of strings that end in \n.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Regex rule, next state, left/right = -1/+1, new value, side effect.</span>
</span></span><span style="display:flex;"><span>    [ <span style="color:#75715e"># State 0:</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^[a-z ]$&#39;</span>, <span style="color:#ae81ff">0</span>, <span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#66d9ef">lambda</span> x: print(x, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)],
</span></span><span style="display:flex;"><span>        [<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^\n$&#39;</span>, <span style="color:#ae81ff">1</span>, <span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#66d9ef">lambda</span> x: print(x, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)],
</span></span><span style="display:flex;"><span>        [<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^.*$&#39;</span>, <span style="color:#ae81ff">0</span>, <span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;NO&#39;</span>, <span style="color:#66d9ef">None</span>],
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    [ <span style="color:#75715e"># State 1:</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^$&#39;</span>, <span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;YES&#39;</span>, <span style="color:#66d9ef">None</span>]
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>])
</span></span></code></pre></div><p>Obfuscation again consists of converting the above code into lambda functions using Y combinators. This is a nice programming exercise, so I&rsquo;ve left it out of this post in case anyone wants to try. The Turing machine has to return <code>'YES'</code> to indicate that it accepts the string, thus the assertion. Our final obfuscated JAPH is a single expression.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">assert</span><span style="color:#e6db74">&#39;&#39;&#39;YES&#39;&#39;&#39;</span><span style="color:#f92672">==</span>(<span style="color:#66d9ef">lambda</span> g:(<span style="color:#66d9ef">lambda</span> f:g(<span style="color:#66d9ef">lambda</span> arg:f(f)(arg)))(<span style="color:#66d9ef">lambda</span> f:g(
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">lambda</span> arg: f(f)(arg))))(<span style="color:#66d9ef">lambda</span> f: <span style="color:#66d9ef">lambda</span> q:[(<span style="color:#66d9ef">lambda</span> g:(<span style="color:#66d9ef">lambda</span> f:g(<span style="color:#66d9ef">lambda</span>
</span></span><span style="display:flex;"><span>arg:f(f)(arg)))(<span style="color:#66d9ef">lambda</span> f: g(<span style="color:#66d9ef">lambda</span> arg:f(f)(arg))))(<span style="color:#66d9ef">lambda</span> f: <span style="color:#66d9ef">lambda</span> x:(x
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]<span style="color:#66d9ef">if</span> x[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">and</span> __import__(<span style="color:#e6db74">&#39;re&#39;</span>)<span style="color:#f92672">.</span><span style="color:#66d9ef">match</span>(x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>],x[<span style="color:#ae81ff">1</span>])<span style="color:#66d9ef">else</span> f([x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>:]
</span></span><span style="display:flex;"><span>,x[<span style="color:#ae81ff">1</span>]]))) ([q[<span style="color:#ae81ff">3</span>][q[<span style="color:#ae81ff">1</span>]],q[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>get(q[<span style="color:#ae81ff">0</span>],<span style="color:#e6db74">&#39;&#39;</span>)])[<span style="color:#ae81ff">4</span>](q[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>get(q[<span style="color:#ae81ff">0</span>],<span style="color:#e6db74">&#39;&#39;</span>)), (<span style="color:#66d9ef">lambda</span>
</span></span><span style="display:flex;"><span>g:(<span style="color:#66d9ef">lambda</span> f:g(<span style="color:#66d9ef">lambda</span> arg:f(f)(arg))) (<span style="color:#66d9ef">lambda</span> f:g(<span style="color:#66d9ef">lambda</span> arg:f(f)(arg))))(
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">lambda</span> f:<span style="color:#66d9ef">lambda</span> x:(x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]<span style="color:#66d9ef">if</span> x[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">and</span> __import__(<span style="color:#e6db74">&#39;re&#39;</span>)<span style="color:#f92672">.</span><span style="color:#66d9ef">match</span>(x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>],x
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">1</span>])<span style="color:#66d9ef">else</span> f([x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>:],x[<span style="color:#ae81ff">1</span>]])))([q[<span style="color:#ae81ff">3</span>][q[<span style="color:#ae81ff">1</span>]],q[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>get(q[<span style="color:#ae81ff">0</span>],<span style="color:#e6db74">&#39;&#39;</span>)])[<span style="color:#ae81ff">3</span>]<span style="color:#66d9ef">if</span>(<span style="color:#66d9ef">lambda</span>
</span></span><span style="display:flex;"><span>g:(<span style="color:#66d9ef">lambda</span> f:g(<span style="color:#66d9ef">lambda</span> arg:f(f)(arg))) (<span style="color:#66d9ef">lambda</span> f:g(<span style="color:#66d9ef">lambda</span> arg:f(f)(arg))))(
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">lambda</span> f:<span style="color:#66d9ef">lambda</span> x:(x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]<span style="color:#66d9ef">if</span> x[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">and</span> __import__(<span style="color:#e6db74">&#39;re&#39;</span>)<span style="color:#f92672">.</span><span style="color:#66d9ef">match</span>(x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>],x[
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>]) <span style="color:#66d9ef">else</span> f([x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>:],x[<span style="color:#ae81ff">1</span>]])))([q[<span style="color:#ae81ff">3</span>][q[<span style="color:#ae81ff">1</span>]],q[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>get(q[<span style="color:#ae81ff">0</span>],<span style="color:#e6db74">&#39;&#39;</span>)])[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">in</span>(<span style="color:#e6db74">&#39;YES&#39;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;NO&#39;</span>)<span style="color:#66d9ef">else</span> f([q[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span>(<span style="color:#66d9ef">lambda</span> g:(<span style="color:#66d9ef">lambda</span> f:g(<span style="color:#66d9ef">lambda</span> arg:f(f)(arg)))(<span style="color:#66d9ef">lambda</span> f:g
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">lambda</span> arg:f(f)(arg))))(<span style="color:#66d9ef">lambda</span> f:<span style="color:#66d9ef">lambda</span> x:(x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]<span style="color:#66d9ef">if</span> x[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">and</span> __import__(
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;re&#39;</span>)<span style="color:#f92672">.</span><span style="color:#66d9ef">match</span>(x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>],x[<span style="color:#ae81ff">1</span>])<span style="color:#66d9ef">else</span> f([x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>:], x[<span style="color:#ae81ff">1</span>]])))([q[<span style="color:#ae81ff">3</span>][q[<span style="color:#ae81ff">1</span>]], q[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>get(q[<span style="color:#ae81ff">0</span>],<span style="color:#e6db74">&#39;&#39;</span>)])[<span style="color:#ae81ff">2</span>],(<span style="color:#66d9ef">lambda</span> g:(<span style="color:#66d9ef">lambda</span> f:g(<span style="color:#66d9ef">lambda</span> arg: f(f)(arg)))(<span style="color:#66d9ef">lambda</span> f:
</span></span><span style="display:flex;"><span>g(<span style="color:#66d9ef">lambda</span> arg:f(f)(arg))))(<span style="color:#66d9ef">lambda</span> f:<span style="color:#66d9ef">lambda</span> x:(x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]<span style="color:#66d9ef">if</span> x[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">and</span> __import__
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;re&#39;</span>)<span style="color:#f92672">.</span><span style="color:#66d9ef">match</span>(x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>],x[<span style="color:#ae81ff">1</span>])<span style="color:#66d9ef">else</span> f([x[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>:], x[<span style="color:#ae81ff">1</span>]])))([q[<span style="color:#ae81ff">3</span>][q[<span style="color:#ae81ff">1</span>]],q[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>get(q[<span style="color:#ae81ff">0</span>],<span style="color:#e6db74">&#39;&#39;</span>)])[<span style="color:#ae81ff">1</span>],q[<span style="color:#ae81ff">2</span>],q[<span style="color:#ae81ff">3</span>]])][<span style="color:#ae81ff">1</span>])([<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,{i:x <span style="color:#66d9ef">for</span> i,x <span style="color:#f92672">in</span> enumerate(<span style="color:#e6db74">&#39;just &#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;another python hacker</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)}, [[[<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^[a-z ]$&#39;</span>,<span style="color:#ae81ff">0</span>,<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;&#39;</span>,<span style="color:#66d9ef">lambda</span> x:print(x,end<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;</span>)], [<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^\n$&#39;</span>,<span style="color:#ae81ff">1</span>,<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;&#39;</span>,<span style="color:#66d9ef">lambda</span> x:print(x, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)],[<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^.*$&#39;</span>,<span style="color:#ae81ff">0</span>,<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;&#39;&#39;NO&#39;&#39;&#39;</span>,
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">lambda</span> x:<span style="color:#66d9ef">None</span>]], [[<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;&#39;&#39;^$&#39;&#39;&#39;</span>,<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;&#39;&#39;YES&#39;&#39;&#39;</span>, <span style="color:#66d9ef">lambda</span> x: <span style="color:#66d9ef">None</span> <span style="color:#f92672">or</span> <span style="color:#66d9ef">None</span>]]]])
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>üê™ Reformed JAPHs: Huffman Coding</title>
      <link>https://ryanjoneil.github.io/posts/2011-04-14-reformed-japhs-huffman-coding/</link>
      <pubDate>Thu, 14 Apr 2011 00:00:00 +0000</pubDate>
      
      <guid>https://ryanjoneil.github.io/posts/2011-04-14-reformed-japhs-huffman-coding/</guid>
      <description>Python obfuscation and Huffman coding</description>
      <content:encoded><![CDATA[<p><em>Note: This post was edited for clarity.</em></p>
<p>At this point, tricking <code>python</code> into printing strings via indirect means got a little boring. So I switched to obfuscating fundamental computer science algorithms. Here&rsquo;s a JAPH that takes in a <a href="https://en.wikipedia.org/wiki/Huffman_coding">Huffman coded</a> version of <code>'just another python hacker'</code>, decodes, and prints it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Build coding tree</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build_tree</span>(scheme):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> scheme<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#39;*&#39;</span>):
</span></span><span style="display:flex;"><span>        left, scheme <span style="color:#f92672">=</span> build_tree(scheme[<span style="color:#ae81ff">1</span>:])
</span></span><span style="display:flex;"><span>        right, scheme <span style="color:#f92672">=</span> build_tree(scheme)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (left, right), scheme
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> scheme[<span style="color:#ae81ff">0</span>], scheme[<span style="color:#ae81ff">1</span>:]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decode</span>(tree, encoded):
</span></span><span style="display:flex;"><span>    ret <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    node <span style="color:#f92672">=</span> tree
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> direction <span style="color:#f92672">in</span> encoded:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> direction <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;0&#39;</span>:
</span></span><span style="display:flex;"><span>            node <span style="color:#f92672">=</span> node[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            node <span style="color:#f92672">=</span> node[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> isinstance(node, str):
</span></span><span style="display:flex;"><span>            ret <span style="color:#f92672">+=</span> node
</span></span><span style="display:flex;"><span>            node <span style="color:#f92672">=</span> tree
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ret
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tree <span style="color:#f92672">=</span> build_tree(<span style="color:#e6db74">&#39;*****ju*sp*er***yct* h**ka*no&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>print(
</span></span><span style="display:flex;"><span>    decode(tree, bin(<span style="color:#ae81ff">10627344201836243859174935587</span>)<span style="color:#f92672">.</span>lstrip(<span style="color:#e6db74">&#39;0b&#39;</span>)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">103</span>))
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>The decoding tree is like a LISP-style sequence of pairs. <code>'*'</code> represents a branch in the tree while other characters are leaf nodes. This looks like the following.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(
</span></span><span style="display:flex;"><span>    (
</span></span><span style="display:flex;"><span>        (
</span></span><span style="display:flex;"><span>            (
</span></span><span style="display:flex;"><span>                (<span style="color:#e6db74">&#39;j&#39;</span>, <span style="color:#e6db74">&#39;u&#39;</span>), 
</span></span><span style="display:flex;"><span>                (<span style="color:#e6db74">&#39;s&#39;</span>, <span style="color:#e6db74">&#39;p&#39;</span>)
</span></span><span style="display:flex;"><span>            ), 
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39;e&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>)
</span></span><span style="display:flex;"><span>        ), 
</span></span><span style="display:flex;"><span>        (
</span></span><span style="display:flex;"><span>            (
</span></span><span style="display:flex;"><span>                (<span style="color:#e6db74">&#39;y&#39;</span>, <span style="color:#e6db74">&#39;c&#39;</span>), 
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;t&#39;</span>
</span></span><span style="display:flex;"><span>            ), 
</span></span><span style="display:flex;"><span>            (<span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#e6db74">&#39;h&#39;</span>)
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    ), 
</span></span><span style="display:flex;"><span>    (
</span></span><span style="display:flex;"><span>        (<span style="color:#e6db74">&#39;k&#39;</span>, <span style="color:#e6db74">&#39;a&#39;</span>), 
</span></span><span style="display:flex;"><span>        (<span style="color:#e6db74">&#39;n&#39;</span>, <span style="color:#e6db74">&#39;o&#39;</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>The actual Huffman coded version of our favorite string gets about 50% smaller represented in base-2.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>0000000001000100101011010111011101010111001000110110000110100001010111111110011001111010100110000100011
</span></span></code></pre></div><p>There&rsquo;s a catch here, which is that this is hard to obfuscate unless we turn it into a single expression. This means that we have to convert <code>build_tree</code> and <code>decode</code> into lambda functions. Unfortunately, they are recursive and lambda functions recurse naturally. Fortunately, we can use <a href="https://code.activestate.com/recipes/576366-y-combinator/">Y combinators</a> to get around the problem. These are worth some study since they will pop up again in future JAPHs.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> g: (
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">lambda</span> f: g(<span style="color:#66d9ef">lambda</span> arg: f(f)(arg))) (<span style="color:#66d9ef">lambda</span> f: g(<span style="color:#66d9ef">lambda</span> arg: f(f)(arg))
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>build_tree <span style="color:#f92672">=</span> Y(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">lambda</span> f: <span style="color:#66d9ef">lambda</span> scheme: (
</span></span><span style="display:flex;"><span>        (f(scheme[<span style="color:#ae81ff">1</span>:])[<span style="color:#ae81ff">0</span>], f(f(scheme[<span style="color:#ae81ff">1</span>:])[<span style="color:#ae81ff">1</span>])[<span style="color:#ae81ff">0</span>]),
</span></span><span style="display:flex;"><span>        f(f(scheme[<span style="color:#ae81ff">1</span>:])[<span style="color:#ae81ff">1</span>])[<span style="color:#ae81ff">1</span> ]
</span></span><span style="display:flex;"><span>    ) <span style="color:#66d9ef">if</span> scheme<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#39;*&#39;</span>) <span style="color:#66d9ef">else</span> (scheme[<span style="color:#ae81ff">0</span>], scheme[<span style="color:#ae81ff">1</span>:])
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>decode <span style="color:#f92672">=</span> Y(<span style="color:#66d9ef">lambda</span> f: <span style="color:#66d9ef">lambda</span> x: x[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">+</span>x[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> x[<span style="color:#ae81ff">2</span>] <span style="color:#66d9ef">else</span> (
</span></span><span style="display:flex;"><span>    f([x[<span style="color:#ae81ff">0</span>], x[<span style="color:#ae81ff">0</span>], x[<span style="color:#ae81ff">2</span>], x[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">+</span>x[<span style="color:#ae81ff">1</span>]]) <span style="color:#66d9ef">if</span> isinstance(x[<span style="color:#ae81ff">1</span>], str) <span style="color:#66d9ef">else</span> (
</span></span><span style="display:flex;"><span>        f([x[<span style="color:#ae81ff">0</span>], x[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>], x[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>:], x[<span style="color:#ae81ff">3</span>]]) <span style="color:#66d9ef">if</span> x[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;0&#39;</span> <span style="color:#66d9ef">else</span> (
</span></span><span style="display:flex;"><span>            f([x[<span style="color:#ae81ff">0</span>], x[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>], x[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>:], x[<span style="color:#ae81ff">3</span>]])
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tree <span style="color:#f92672">=</span> build_tree(<span style="color:#e6db74">&#39;*****ju*sp*er***yct* h**ka*no&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>print(
</span></span><span style="display:flex;"><span>    decode([
</span></span><span style="display:flex;"><span>        tree,
</span></span><span style="display:flex;"><span>        tree,
</span></span><span style="display:flex;"><span>        bin(<span style="color:#ae81ff">10627344201836243859174935587</span>)<span style="color:#f92672">.</span>lstrip(<span style="color:#e6db74">&#39;0b&#39;</span>)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">103</span>), <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    ])
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>The final version is a condensed (and expanded, oddly) version of the above.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print((<span style="color:#66d9ef">lambda</span> t,e,s:(<span style="color:#66d9ef">lambda</span> g:(<span style="color:#66d9ef">lambda</span> f:g(<span style="color:#66d9ef">lambda</span> arg:f(f)(arg)))(<span style="color:#66d9ef">lambda</span> f:
</span></span><span style="display:flex;"><span>g(<span style="color:#66d9ef">lambda</span> arg: f(f)(arg))))(<span style="color:#66d9ef">lambda</span> f:<span style="color:#66d9ef">lambda</span> x: x[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">+</span>x[<span style="color:#ae81ff">1</span>]<span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> x[<span style="color:#ae81ff">2</span>]<span style="color:#66d9ef">else</span> f([
</span></span><span style="display:flex;"><span>x[<span style="color:#ae81ff">0</span>],x[<span style="color:#ae81ff">0</span>],x[<span style="color:#ae81ff">2</span>],x[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">+</span>x[<span style="color:#ae81ff">1</span>]])<span style="color:#66d9ef">if</span> isinstance(x[<span style="color:#ae81ff">1</span>],str)<span style="color:#66d9ef">else</span> f([x[<span style="color:#ae81ff">0</span>],x[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>],x[<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">1</span>:],x[<span style="color:#ae81ff">3</span>]])<span style="color:#66d9ef">if</span> x[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;0&#39;</span><span style="color:#66d9ef">else</span> f([x[<span style="color:#ae81ff">0</span>],x[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>],x[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>:],x[<span style="color:#ae81ff">3</span>]]))([t,t,e,s])
</span></span><span style="display:flex;"><span>)((<span style="color:#66d9ef">lambda</span> g:(<span style="color:#66d9ef">lambda</span> f:g(<span style="color:#66d9ef">lambda</span> arg:f(f)(arg)))(<span style="color:#66d9ef">lambda</span> f:g(<span style="color:#66d9ef">lambda</span> arg:f(f)(
</span></span><span style="display:flex;"><span>arg))))(<span style="color:#66d9ef">lambda</span> f:<span style="color:#66d9ef">lambda</span> p:((f(p[<span style="color:#ae81ff">1</span>:])[<span style="color:#ae81ff">0</span>],f(f(p[<span style="color:#ae81ff">1</span>:])[<span style="color:#ae81ff">1</span>])[<span style="color:#ae81ff">0</span>]),f(f(p[<span style="color:#ae81ff">1</span>:])[<span style="color:#ae81ff">1</span>])[
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>])<span style="color:#66d9ef">if</span> p<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#39;*&#39;</span>)<span style="color:#66d9ef">else</span>(p[<span style="color:#ae81ff">0</span>],p[<span style="color:#ae81ff">1</span>:]))(<span style="color:#e6db74">&#39;*****ju*sp*er***yct* h**ka*no&#39;</span>)[
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span>],bin(<span style="color:#ae81ff">10627344201836243859179756385</span><span style="color:#f92672">-</span><span style="color:#ae81ff">4820798</span>)<span style="color:#f92672">.</span>lstrip(<span style="color:#e6db74">&#39;0b&#39;</span>)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">103</span>),<span style="color:#e6db74">&#39;&#39;</span>))
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>üê™ Reformed JAPHs: Rolling Effect</title>
      <link>https://ryanjoneil.github.io/posts/2011-04-11-reformed-japhs-rolling-effect/</link>
      <pubDate>Mon, 11 Apr 2011 00:00:00 +0000</pubDate>
      
      <guid>https://ryanjoneil.github.io/posts/2011-04-11-reformed-japhs-rolling-effect/</guid>
      <description>Python obfuscation with a cute visual effect</description>
      <content:encoded><![CDATA[<p><em>Note: This post was updated to work with Python 3.12. It may not work with different versions.</em></p>
<p>Here&rsquo;s a JAPH composed solely for effect. For each letter in <code>'just another python hacker'</code> it loops over each the characters <code>' abcdefghijklmnopqrstuvwxyz'</code>, printing each. Between characters it pauses for 0.05 seconds, backing up and moving on to the next if it hasn&rsquo;t reached the desired one yet. This achieves a sort of rolling effect by which the final string appears on our screen over time.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> string
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>letters <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39; &#39;</span> <span style="color:#f92672">+</span> string<span style="color:#f92672">.</span>ascii_lowercase
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> <span style="color:#e6db74">&#39;just another python hacker&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> letters:
</span></span><span style="display:flex;"><span>        print(x, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>        sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>flush()
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0.05</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> x <span style="color:#f92672">==</span> l:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\b</span><span style="color:#e6db74">&#39;</span>, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print()
</span></span></code></pre></div><p>We locate and print each letter in the string with a list comprehension.  At the end we have an extra line of code (the eval statement) that gives us our newline.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[[(<span style="color:#66d9ef">lambda</span> x,l:str(print(x,end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>))<span style="color:#f92672">+</span>str(__import__(print<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>__doc__[print<span style="color:#f92672">.</span>__doc__<span style="color:#f92672">.</span>index(<span style="color:#e6db74">&#39;stdout&#39;</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">4</span>:print<span style="color:#f92672">.</span>__doc__<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>index(<span style="color:#e6db74">&#39;stdout&#39;</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>flush()) <span style="color:#f92672">+</span> str(__import__(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>join(reversed(<span style="color:#e6db74">&#39;emit&#39;</span>)))<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0o5</span><span style="color:#f92672">*</span><span style="color:#ae81ff">1.01</span><span style="color:#f92672">/</span><span style="color:#ae81ff">0x64</span>))<span style="color:#f92672">+</span>str(print(
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\b</span><span style="color:#e6db74">&#39;</span>,end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x09</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>strip())<span style="color:#66d9ef">if</span> x<span style="color:#f92672">!=</span>l <span style="color:#66d9ef">else</span><span style="color:#e6db74">&#39;*&amp;#&#39;</span>))(x1,l1)<span style="color:#66d9ef">for</span> x1
</span></span><span style="display:flex;"><span><span style="color:#f92672">in</span>(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x20</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>getattr(__import__(type(<span style="color:#e6db74">&#39;phear&#39;</span>)<span style="color:#f92672">.</span>__name__<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;in&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;g&#39;</span>),dir(__import__(type(<span style="color:#e6db74">&#39;snarf&#39;</span>)<span style="color:#f92672">.</span>__name__<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;ing&#39;</span>))[<span style="color:#ae81ff">15</span>]))
</span></span><span style="display:flex;"><span>[:(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x20</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>getattr(__import__(type(<span style="color:#e6db74">&#39;smear&#39;</span>)<span style="color:#f92672">.</span>__name__<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;in&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;g&#39;</span>),dir(__import__(type(<span style="color:#e6db74">&#39;slurp&#39;</span>)<span style="color:#f92672">.</span>__name__<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;ing&#39;</span>))[<span style="color:#ae81ff">15</span>]))
</span></span><span style="display:flex;"><span><span style="color:#f92672">.</span>index(l1)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]]<span style="color:#66d9ef">for</span> l1 <span style="color:#f92672">in</span><span style="color:#e6db74">&#39;&#39;&#39;just another python hacker&#39;&#39;&#39;</span>]
</span></span><span style="display:flex;"><span>eval(<span style="color:#e6db74">&#39;&#39;&#39;</span><span style="color:#ae81ff">\x20\x09</span><span style="color:#e6db74">eval(&#34;</span><span style="color:#ae81ff">\x20\x09</span><span style="color:#e6db74">eval(&#39;</span><span style="color:#ae81ff">\x20</span><span style="color:#e6db74"> print()&#39;)&#34;)&#39;&#39;&#39;</span>)
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>üê™ Reformed JAPHs: ROT13</title>
      <link>https://ryanjoneil.github.io/posts/2011-04-06-reformed-japhs-rot13/</link>
      <pubDate>Wed, 06 Apr 2011 00:00:00 +0000</pubDate>
      
      <guid>https://ryanjoneil.github.io/posts/2011-04-06-reformed-japhs-rot13/</guid>
      <description>Python obfuscation using ROT13 encoding</description>
      <content:encoded><![CDATA[<p><em>Note: This post was updated to work with Python 3.12. It may not work with different versions.</em></p>
<p>No series of JAPHs would be complete without <a href="https://en.wikipedia.org/wiki/ROT13">ROT13</a>. This is the example through which aspiring Perl programmers learn to use <code>tr</code> and its synonym <code>y</code>. In Perl the basic ROT13 JAPH starts as:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-perl" data-lang="perl"><span style="display:flex;"><span>$foo <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;whfg nabgure crey unpxre&#39;</span>;
</span></span><span style="display:flex;"><span>$foo <span style="color:#f92672">=~</span> y<span style="color:#e6db74">/a-z/</span>n<span style="color:#f92672">-</span>za<span style="color:#f92672">-</span><span style="color:#e6db74">m</span><span style="color:#960050;background-color:#1e0010">/;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">print</span> $foo;
</span></span></code></pre></div><p>Python has nothing quite so elegant in its default namespace. However, this does give us the opportunity to explore a little used aspect of strings: the translate method. If we construct a dictionary of ordinals we can accomplish the same thing with a touch more effort.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> string
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>table <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    ord(x): ord(y) <span style="color:#66d9ef">for</span> x, y <span style="color:#f92672">in</span> zip(
</span></span><span style="display:flex;"><span>        string<span style="color:#f92672">.</span>ascii_lowercase,
</span></span><span style="display:flex;"><span>        string<span style="color:#f92672">.</span>ascii_lowercase[<span style="color:#ae81ff">13</span>:] <span style="color:#f92672">+</span> string<span style="color:#f92672">.</span>ascii_lowercase
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;whfg nabgure clguba unpxre&#39;</span><span style="color:#f92672">.</span>translate(table))
</span></span></code></pre></div><p>We obfuscate the construction of this translation dictionary and, for added measure, use <code>getattr</code> to find the <code>print</code> function off of <code>__builtins__</code>.  This will likely only work in Python 3.2, since the order of attributes on <code>__builtins__</code> matters.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>getattr(vars()[list(filter(<span style="color:#66d9ef">lambda</span> _:<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x5f\x62</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">in</span> _,dir
</span></span><span style="display:flex;"><span>()))[<span style="color:#ae81ff">0</span>]], dir(vars()[list(filter(<span style="color:#66d9ef">lambda</span> _:<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x5f\x62</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">in</span>
</span></span><span style="display:flex;"><span>_, dir()))[<span style="color:#ae81ff">0</span>]])[list(filter(<span style="color:#66d9ef">lambda</span> _:_ [<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>startswith(
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x70\x72</span><span style="color:#e6db74">&#39;</span>),enumerate(dir(vars()[list(filter(<span style="color:#66d9ef">lambda</span> _:
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x5f\x62</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">in</span> _,dir()))[<span style="color:#ae81ff">0</span>]]))))[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]])(getattr(<span style="color:#e6db74">&#39;whfg &#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&#39;&#39;nabgure clguba unpxre&#39;&#39;&#39;</span>, dir(<span style="color:#e6db74">&#39;0o52&#39;</span>)[<span style="color:#ae81ff">0o116</span>])({ _:
</span></span><span style="display:flex;"><span>(_<span style="color:#f92672">-</span><span style="color:#ae81ff">0o124</span>) <span style="color:#f92672">%</span><span style="color:#ae81ff">0o32</span> <span style="color:#f92672">+</span><span style="color:#ae81ff">0o141</span> <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0o141</span>, <span style="color:#ae81ff">0o173</span>)}))
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>üê™ Reformed JAPHs: Ridiculous Anagram</title>
      <link>https://ryanjoneil.github.io/posts/2011-04-03-reformed-japhs-ridiculous-anagram/</link>
      <pubDate>Sun, 03 Apr 2011 00:00:00 +0000</pubDate>
      
      <guid>https://ryanjoneil.github.io/posts/2011-04-03-reformed-japhs-ridiculous-anagram/</guid>
      <description>Python obfuscation using anagrams</description>
      <content:encoded><![CDATA[<p>Here&rsquo;s the second in my reformed JAPH series. It takes an anagram of <code>'just another python hacker'</code> and converts it prior to printing. It sorts the anagram by the indices of another string, in order of their associated characters. This is sort of like a pre-digested <a href="https://en.wikipedia.org/wiki/Schwartzian_transform">Schwartzian transform</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;upjohn tehran hectors katy&#39;</span>
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1D0HG6JFO9P5ICKAM87B24NL3E&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(x[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> sorted(range(len(x)), key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> p: y[p])))
</span></span></code></pre></div><p>Obfuscation consists mostly of using silly machinations to construct the string we use to sort the anagram.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39;&#39;&#39;upjohn tehran hectors katy&#39;&#39;&#39;</span>[_]<span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> sorted(range
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">26</span>),key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> p:(hex(<span style="color:#ae81ff">29</span>)[<span style="color:#ae81ff">2</span>:]<span style="color:#f92672">.</span>upper()<span style="color:#f92672">+</span>str(<span style="color:#ae81ff">3</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span><span style="color:#f92672">-</span><span style="color:#ae81ff">3</span><span style="color:#f92672">**</span><span style="color:#ae81ff">4</span>)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;HG&#39;</span><span style="color:#f92672">+</span>str(sum(
</span></span><span style="display:flex;"><span>range(<span style="color:#ae81ff">4</span>)))<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;JFO&#39;</span><span style="color:#f92672">+</span>str((<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>))<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;P&#39;</span><span style="color:#f92672">+</span>str(<span style="color:#ae81ff">35</span><span style="color:#f92672">/</span><span style="color:#ae81ff">7</span>)[:<span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;i.c.k.&#39;</span><span style="color:#f92672">.</span>replace(
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;.&#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">.</span>upper()<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;AM&#39;</span><span style="color:#f92672">+</span>str(<span style="color:#ae81ff">3</span><span style="color:#f92672">**</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>sum(range(<span style="color:#ae81ff">5</span>))<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>)<span style="color:#f92672">+</span>hex(<span style="color:#ae81ff">0o5444</span>)[<span style="color:#ae81ff">2</span>:]<span style="color:#f92672">.</span>replace
</span></span><span style="display:flex;"><span>(<span style="color:#f92672">*</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x62</span><span style="color:#e6db74">|</span><span style="color:#ae81ff">\x42</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;|&#39;</span>))<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;NL&#39;</span><span style="color:#f92672">+</span>hex(<span style="color:#ae81ff">0o076</span>)<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;x&#39;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>upper())[p])))
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>üê™ Reformed JAPHs: Alphabetic Indexing</title>
      <link>https://ryanjoneil.github.io/posts/2011-04-01-reformed-japhs-alphabetic-indexing/</link>
      <pubDate>Fri, 01 Apr 2011 00:00:00 +0000</pubDate>
      
      <guid>https://ryanjoneil.github.io/posts/2011-04-01-reformed-japhs-alphabetic-indexing/</guid>
      <description>Python obfuscation</description>
      <content:encoded><![CDATA[<p><em>Note: This post was edited for clarity.</em></p>
<p>Many years ago, I was a Perl programmer. Then one day I became disillusioned at the progress of Perl 6 and decided to <a href="https://www.python.org/dev/peps/pep-0020/">import this</a>.</p>
<p>This seems to be a fairly common story for Perl to Python converts. While I haven&rsquo;t looked back much, there are a number of things I really miss about <code>perl</code> <em>(lower case intentional)</em>. I miss having value types in a dynamic language, magical and ill-advised use of <a href="https://www.foo.be/docs/tpj/issues/vol3_1/tpj0301-0003.html">cryptocontext</a>, and sometimes even <a href="https://web.archive.org/web/20040712204117/https://perldesignpatterns.com/?PseudoHash">pseudohashes</a> because they were inexcusably weird. A language that supports so many ideas out of the box enables an extended learning curve that lasts for <a href="https://web.archive.org/web/20020607034341/https://silver.sucs.org/~manic/humour/languages/perlhacker.htm">many years</a>. &ldquo;Perl itself is the game.&rdquo;</p>
<p>Most of all I think I miss writing Perl <a href="https://www.perlmonks.org/?node=Perl%20Poetry">poetry</a> and <a href="https://en.wikipedia.org/wiki/Just_another_Perl_hacker">JAPHs</a>. Sadly, I didn&rsquo;t keep any of those I wrote, and I&rsquo;m not competent enough with the language anymore to write interesting ones. At the time I was intentionally distancing myself from a model that was largely implicit and based on archaic systems internals and moving to one that was (supposedly) explicit and simple.</p>
<p>After switching to Python as my primary language, I used the following email signature in a nod to this change in orientation <em>(intended for Python 2)</em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print <span style="color:#e6db74">&#39;just another python hacker&#39;</span>
</span></span></code></pre></div><p>Recently I&rsquo;ve been experimenting with writing JAPHs in Python. I think of these as &ldquo;reformed JAPHs.&rdquo; They accomplish the same purpose as programming exercises but in a more restricted context. In some ways they are more challenging. Creativity can be difficult in a narrowly defined landscape.</p>
<p>I have written a small series of reformed JAPHs which increase monotonically in complexity. Here is the first one, written in plain understandable Python 3.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> string
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>letters <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_lowercase <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; &#39;</span>
</span></span><span style="display:flex;"><span>indices <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>     <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">26</span>,  <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">7</span>,  <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">26</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">19</span>,  <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">26</span>,  <span style="color:#ae81ff">7</span>,  <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">10</span>,  <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">17</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(letters[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> indices))
</span></span></code></pre></div><p>This is fairly simple. Instead of explicitly embedding the string <code>'just another python hacker'</code> in the program, we assemble it using the index of its letters in the string <code>'abcdefghijklmnopqrstuvwxyz '</code>. We then obfuscate through a series of minor measures:</p>
<ul>
<li>Instead of calling the print function, we <code>import sys</code> and make a call to <code>sys.stdout.write</code>.</li>
<li>We assemble <code>string.lowercase + ' '</code> by joining together the character versions of its respective ordinal values (97 to 123 and 32).</li>
<li>We join together the integer indices using <code>'l'</code> and split that into a list.</li>
<li>We apply <code>'''</code> liberally and rely on the fact that <code>python</code> concatenates adjacent strings.</li>
</ul>
<p>Here&rsquo;s the obfuscated version:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>eval(<span style="color:#e6db74">&#34;__import__(&#39;&#39;&#39;</span><span style="color:#ae81ff">\x73</span><span style="color:#e6db74">&#39;&#39;&#39;&#39;&#39;&#39;</span><span style="color:#ae81ff">\x79</span><span style="color:#e6db74">&#39;&#39;&#39;&#39;&#39;&#39;</span><span style="color:#ae81ff">\x73</span><span style="color:#e6db74">&#39;&#39;&#39;).sTdOuT&#34;</span><span style="color:#f92672">.</span>lower()
</span></span><span style="display:flex;"><span>)<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(map(<span style="color:#66d9ef">lambda</span> _:(list(map(chr,range(<span style="color:#ae81ff">97</span>,<span style="color:#ae81ff">123</span>)))<span style="color:#f92672">+</span>[chr(
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">32</span>)])[int(_)],(<span style="color:#e6db74">&#39;&#39;&#39;9l20l18l19&#39;&#39;&#39;&#39;&#39;&#39;l26l0l13l14l19l7l4l17l26l15&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;l24l19l7l14l1&#39;&#39;&#39;&#39;&#39;&#39;3l26l7l0l2l10l4l17&#39;&#39;&#39;</span>)<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;l&#39;</span>)))<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>,)
</span></span></code></pre></div><p>We could certainly do more, but that&rsquo;s where I left this one. Stay tuned for the next JAPH.</p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
